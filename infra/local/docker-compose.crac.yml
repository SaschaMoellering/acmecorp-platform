# Docker Compose override for CRaC-enabled Spring Boot services.
# Usage:
#   docker compose -f infra/local/docker-compose.yml -f infra/local/docker-compose.crac.yml <command>

services:
  gateway-service:
    privileged: false
    environment:
      CRAC_ENABLED: "true"
      CRAC_CHECKPOINT_DIR: /opt/crac/gateway-service
      CRAC_HEALTH_PORT: "8080"
      CRAC_HEALTH_PATH: /actuator/health
    volumes:
      - crac-data:/opt/crac

  orders-service:
    privileged: false
    environment:
      CRAC_ENABLED: "true"
      CRAC_CHECKPOINT_DIR: /opt/crac/orders-service
      CRAC_HEALTH_PORT: "8080"
      CRAC_HEALTH_PATH: /actuator/health
    volumes:
      - crac-data:/opt/crac

  billing-service:
    privileged: false
    environment:
      CRAC_ENABLED: "true"
      CRAC_CHECKPOINT_DIR: /opt/crac/billing-service
      CRAC_HEALTH_PORT: "8080"
      CRAC_HEALTH_PATH: /actuator/health
    volumes:
      - crac-data:/opt/crac

  notification-service:
    privileged: false
    environment:
      CRAC_ENABLED: "true"
      CRAC_CHECKPOINT_DIR: /opt/crac/notification-service
      CRAC_HEALTH_PORT: "8080"
      CRAC_HEALTH_PATH: /actuator/health
    volumes:
      - crac-data:/opt/crac

  analytics-service:
    privileged: false
    environment:
      CRAC_ENABLED: "true"
      CRAC_CHECKPOINT_DIR: /opt/crac/analytics-service
      CRAC_HEALTH_PORT: "8080"
      CRAC_HEALTH_PATH: /actuator/health
    volumes:
      - crac-data:/opt/crac

volumes:
  crac-data:
